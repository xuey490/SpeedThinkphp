## SpeedThinkphp

## ç®€è¦ä»‹ç»ï¼š
##### **ä½¿ç”¨ Workerman ä½œä¸ºä¼ ç»Ÿ ThinkPHP 8 æ¡†æž¶ï¼ˆåŽŸæœ¬åŸºäºŽ FPMï¼‰çš„è¿›ç¨‹å¯åŠ¨å™¨**ï¼Œå¯ä»¥è®©å®ƒå˜æˆä¸€ä¸ª**å¸¸é©»å†…å­˜çš„é«˜æ€§èƒ½åº”ç”¨æœåŠ¡å™¨**ã€‚æ— éœ€æ”¹å˜çŽ°æœ‰æž¶æž„ï¼Œå°‘é‡ä¿®æ”¹æˆ–æ— éœ€æ”¹å˜ä»»ä½•ä»£ç ï¼Œå³å¯ä½¿ç”¨ã€‚ä¸€æ¬¡ç¼–å†™ï¼Œæ€§èƒ½æå‡10å€ä»¥ä¸Šã€‚

## æ¯”thinkphpå®˜æ–¹æä¾›çš„ç®€å•å¥½ç”¨ã€‚

#### æ„Ÿå…´è¶£çš„ä¹Ÿå¯ä»¥çœ‹çœ‹æˆ‘çš„æ¡†æž¶ï¼Œä¹Ÿæ˜¯æ”¯æŒworkermanå¯åŠ¨çš„ï¼š
#### https://github.com/xuey490/project

## å…³äºŽå†…å­˜æº¢å‡ºçš„é—®é¢˜ï¼šï¼ˆè¿™æ®µå†™åˆ°å‰é¢ï¼‰
ç”±äºŽTPæ¡†æž¶æ˜¯ä¸ºFPM/çŸ­ç”Ÿå‘½å‘¨æœŸæ¨¡åž‹è®¾è®¡ï¼Œè€ŒWorkerman æ˜¯å¸¸é©»å†…å­˜ï¼Œé•¿ç”Ÿå‘½å‘¨æœŸæ¨¡åž‹ï¼Œæ¯æ¬¡è¯·æ±‚åŽï¼Œæ¡†æž¶ç¤ºä¾‹appï¼Œé™æ€ç±»,Facadeå•ä¾‹ï¼ŒEventï¼ŒCacheï¼Œå®¹å™¨ï¼Œå…¨å±€å˜é‡ï¼Œsessionå˜é‡ï¼ŒLoggerç­‰éƒ½ä¸ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œå¯¼è‡´å†…å­˜æº¢å‡ºçš„
çŽ°åœ¨æŠ˜ä¸­åŠžæ³•æ˜¯å¯¹è¶…è¿‡å†…å­˜é˜ˆå€¼çš„æ—¶å€™ï¼Œè‡ªåŠ¨é‡è½½æœåŠ¡ï¼Œå¯¹linuxæµ‹è¯•ï¼Œé‡è½½å‡ ä¹Žæ— æ„Ÿï¼Œé¡¶å¤šåˆ·æ–°ä¸€æ¬¡ï¼Œä½†å¯¹windowså¯èƒ½ä¼šå¯¼è‡´è¿›ç¨‹ç›´æŽ¥æ­»æŽ‰é€€å‡ºã€‚è¿™æœ‰å¾…ç ”ç©¶å§ã€‚

## ç‰¹æ€§ï¼š
##### âš ï¸ æ— éœ€ Nginx / Apache
##### ðŸš€ ä½¿ç”¨ Workerman ç®¡ç†è¿›ç¨‹ï¼ŒThinkPHP åº”ç”¨å†…æ ¸å¸¸é©»å†…å­˜ï¼Œæ€§èƒ½æ˜¾è‘—æå‡,å•æ¬¡è¯·æ±‚å¯ä»¥åšåˆ°30msä¹‹å†…ã€‚
##### ðŸ“‚ é™æ€æ–‡ä»¶å¤„ç†ï¼ˆå¦‚ /public/js/ã€/public/css/ã€/public/uploads/ ç­‰ï¼‰
##### âš¡å®Œæ•´æ”¯æŒ ThinkPHP8 æ¡†æž¶,ä¿æŒ ThinkPHP åŽŸç”Ÿè·¯ç”±ä¸Žå“åº”é€»è¾‘ï¼ˆå®Œå…¨å…¼å®¹ FPMï¼‰
##### ðŸŒ€ä¼˜é›…è¾“å‡ºä¸Žé”™è¯¯å¤„ç†ã€‚
##### âœ… æ¯ä¸ªè¯·æ±‚è‡ªåŠ¨è½¬æ¢ä¸º ThinkPHP Request å¯¹è±¡äº¤ç»™ Workerman å¤„ç†
##### ðŸ”¥ æ”¯æŒçƒ­æ›´æ–°ï¼ˆæ£€æµ‹ app/ã€config/ã€route/ å˜åŒ–è‡ªåŠ¨é‡å¯workerï¼‰--æœ‰å¾…å®Œå–„
##### ðŸ’¾æ”¯æŒä¼˜é›…é€€å‡ºï¼Œå®šæœŸæ£€æµ‹å†…å­˜å ç”¨ï¼ˆè¶…è¿‡é˜ˆå€¼è‡ªåŠ¨ä¼˜é›…é‡å¯ï¼‰
##### ðŸªµè¾“å‡ºè¿è¡Œæ—¥å¿—ï¼ˆå«å“åº”æ—¶é—´ã€çŠ¶æ€ç ã€URIï¼‰
## ç›®å½•ç»“æž„
    project-root/
    â”œâ”€ thinkphp/
    â”œâ”€ app/
    â”œâ”€ config/
    â”œâ”€ public/
    â”‚   â””â”€ index.php        â† åŽŸå§‹ FPM å…¥å£æ–‡ä»¶
    â”œâ”€ server.php           â† Workerman å¯åŠ¨å™¨ï¼ˆæ–°å¢žçš„ï¼‰
    â””â”€ composer.json

## ä½¿ç”¨æ–¹æ³•
åœ¨ä½ çŽ°æœ‰çš„é¡¹ç›®ç›®å½•ä¸‹ï¼ŒComposerå®‰è£…ï¼š

`composer require workerman/workerman`

**æœ‰äº›composerä»£ç†é•œåƒä¸å…¨ï¼Œä½¿ç”¨ä»¥ä¸Šå‘½ä»¤composer config -g --unset repos.packagist ç§»é™¤ä»£ç†ï¼Œå†å®‰è£…**

##### å¯åŠ¨
`php server.php start`

##### å¼€å‘æ¨¡å¼ï¼ˆå¸¦çƒ­æ›´æ–°ï¼‰--æœ‰å¾…å®Œå–„
`php server.php start --debug`

##### åœæ­¢
`php server.php stop`

##### é‡å¯
`php server.php restart`

##### è®¿é—®ï¼šhttp://127.0.0.1:8787

## ç”Ÿäº§éƒ¨ç½²å»ºè®®
| é¡¹ç›®               | æŽ¨èå€¼                                  |
| ---------------- | ------------------------------------ |
| `$worker->count` | CPUæ ¸å¿ƒæ•°ï¼ˆå»ºè®®=4æˆ–æ›´å¤šï¼‰                      |
| å†…å­˜é˜ˆå€¼ `$limitMB`  | 256~512 MB ä¹‹é—´                        |
| Cache-Control    | `max-age=3600` å¯æŒ‰éœ€æ±‚è°ƒæ•´                |
| å®ˆæŠ¤æ¨¡å¼             | `php server.php start -d`            |
| æ—¥å¿—               | å»ºè®®ä½¿ç”¨ Workerman è‡ªå¸¦æ—¥å¿— `/workerman.log` |


## æ€§èƒ½ä¼˜åŠ¿
| ç‰¹æ€§      | è¯´æ˜Ž                          |
| ------- | --------------------------- |
| ðŸš€ å¸¸é©»å†…å­˜ | æ¡†æž¶æ ¸å¿ƒåªåˆå§‹åŒ–ä¸€æ¬¡ï¼Œæ€§èƒ½å¯æå‡ 5~10 å€     |
| â™»ï¸ çƒ­æ›´æ–°  | æ–‡ä»¶æ”¹åŠ¨è‡ªåŠ¨é‡å¯ Workerï¼Œå…æ‰‹åŠ¨         |
| ðŸ§  å†…å­˜ç›‘æŽ§ | è¶…å‡ºé™åˆ¶è‡ªåŠ¨é‡å¯è¿›ç¨‹                  |
| ðŸ’¡ å…¼å®¹æ€§  | å®Œå…¨å…¼å®¹ ThinkPHP åŽŸæœ‰ä»£ç ï¼Œä¸éœ€æ”¹ä»»ä½•æŽ§åˆ¶å™¨ |
| âš™ï¸ çµæ´»   | å¯æŒ‚è½½å¤šåº”ç”¨ã€APIã€åŽå°ç­‰ä¸åŒ Worker     |

## å·¥ä½œæœºåˆ¶
| æ¨¡å—                   | åŠŸèƒ½                                        |
| -------------------- | ----------------------------------------- |
| `build_server()`     | æŠŠ Workerman çš„è¯·æ±‚å¤´æ˜ å°„åˆ° PHP è¶…å…¨å±€ `$_SERVER`    |
| `App()->http->run()` | è°ƒç”¨ ThinkPHP çš„åŽŸç”Ÿ HTTP å†…æ ¸ï¼Œæ‰§è¡Œè·¯ç”±åŒ¹é…ã€æŽ§åˆ¶å™¨è°ƒç”¨ã€è¿”å›žå“åº” |
| `Response`           | ç›´æŽ¥ä½¿ç”¨ ThinkPHP è¿”å›žå¯¹è±¡çš„å†…å®¹ã€çŠ¶æ€ç ã€å¤´éƒ¨              |
| `http->end()`        | é‡Šæ”¾ä¸Šä¸‹æ–‡ï¼ˆé˜²æ­¢è¯·æ±‚é—´å†…å­˜æ±¡æŸ“ï¼‰                          |
## æ—¥å¿—å®žä¾‹
```c
[2025-10-25 18:21:12] GET / 2.14ms
[2025-10-25 18:21:15] GET /public/js/app.js 0.73ms
[2025-10-25 18:21:19] POST /api/user/login 3.81ms
```


